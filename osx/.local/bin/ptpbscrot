#!/usr/bin/env bash
# Used as an Automator action.

[[ ! "$1" || "$1" == *.ptpb ]] && exit

out="$(curl -sF "c=@$1" "https://ptpb.pw/")"
cat <<< "$out" > "$(dirname "$1")/.$(basename "$1").ptpb"
url="$(awk '/^url:/{print $2}' <<< "$out")"
pbcopy <<< "$url"

osascript <<EOF
  display notification "$url" with title "Screenshot URL on clipboard." sound name "Pop"
EOF
